// nextflow.config
workDir = "/scratch1/$USER/nxf-work"
def SCR = System.getenv('SCRATCH')
workDir = SCR ? "${SCR}/nxf-work" : "${baseDir}/work"

profiles {
  singularity {
    singularity.enabled     = true
    singularity.autoMounts  = true
    process.executor        = 'local'
    process.container       = "${projectDir}/occufold.sif"
    singularity.runOptions  = "-B ${projectDir}:${projectDir} -B /project:/project --env PYTHONPATH=${projectDir} --env MPLCONFIGDIR=/tmp/mpl"
  }
}

process {
  echo = true
  withName: PREPROCESS {
    cpus   = 1
    memory = '5 GB'
    time   = '1h'
  }
  withName: PREDICT {
    cpus   = 1
    memory = '5 GB'
    time   = '1h'
  }
  withName: BARRIERS {
    cpus   = 1
    memory = '5 GB'
    time   = '1h'
  }
}

params {
  bed    = null
  region = null
  peaks  = null
  motifs = null
  outdir = "results"

  use_predicted_occupancy = true
  model_weights = 'workflow/files/model_weights'
  ctcfpfm = 'workflow/files/MA0139.1.pfm'

  lattice_site = 250
  paramdict = "${projectDir}/workflow/files/ctcfparams.json"
}
