// Fast scratch for task work dirs use
workDir = "/scratch1/$USER/nxf-work"
// Work dir: use $SCRATCH if available; else use project-local ./work
def SCR = System.getenv('SCRATCH')
workDir = SCR ? "${SCR}/nxf-work" : "${baseDir}/work"

profiles {
  singularity {
    singularity.enabled     = true
    singularity.autoMounts  = true
    process.executor        = 'local'
    process.container       = "${projectDir}/occufold.sif"

    // Bind your repo and /project so files are visible in the container.
    // Pass PYTHONPATH so the container can import your OccuFold code (dev mode).
    // Also set a writable MPL cache.
    singularity.runOptions  = "-B ${projectDir}:${projectDir} -B /project:/project --env PYTHONPATH=${projectDir} --env MPLCONFIGDIR=/tmp/mpl"
  }
}

// Optional: resources and echo for debugging
process {
  echo = true
  withName: PREPROCESS {
    cpus   = 1
    memory = '5 GB'
    time   = '1h'
  }
  withName: PREDICT {
    cpus   = 1
    memory = '5 GB'
    time   = '1h'
  }
}

// Defaults to avoid warnings
params {
  bed    = null
  region = null
  peaks  = null
  motifs = null
  outdir = "results"

  use_predicted_occupancy = true
  model_weights = 'workflow/files/model_weights'
  ctcfpfm = 'workflow/files/MA0139.1.pfm'
}












